<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title th:text="${movie != null ? movie.name : 'Chi tiết phim'}">Chi tiết phim</title>
    <link rel="stylesheet" th:href="@{/web/assets/css/style-starter.css}">
    <link rel="stylesheet" th:href="@{/web/assets/css/movie_detail.css}">
    <link href="//fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,600;0,700;1,600&display=swap" rel="stylesheet">
    <style>
.movie-review {
    background: #181818;
    border-radius: 10px;
    padding: 16px 20px;
    margin-bottom: 18px;
    color: #fff;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
}
.movie-review .review-user {
    font-size: 1rem;
    color: #e67e22;
    margin-bottom: 4px;
}
.movie-review .review-rating {
    color: #f1c40f;
    margin-bottom: 4px;
}
.movie-review .review-comment {
    margin-bottom: 4px;
    font-size: 1.05rem;
}
.movie-review .review-date {
    font-size: 0.95rem;
    color: #aaa;
}
</style>
</head>
<body>
    <!-- header -->
    <header id="site-header" class="w3l-header fixed-top">
        <!--/nav-->
        <nav class="navbar navbar-expand-lg navbar-light fill px-lg-0 py-0 px-3">
            <div class="container">
                <h1><a class="navbar-brand" th:href="@{/}"><span class="fa fa-play icon-log" aria-hidden="true"></span> MyShowz </a></h1>
                <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="fa icon-expand fa-bars"></span>
                    <span class="fa icon-close fa-times"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/}">Home</a>
                        </li>
                        <li class="nav-item active">
                            <a class="nav-link" th:href="@{/movies}">Movies</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/movie_theater}">Movie Theater</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/contact}">Contact</a>
                        </li>
                    </ul>
                    <div class="Login_SignUp" id="login" style="font-size: 2rem ; display: inline-block; position: relative;">
                        <a class="nav-link" th:href="@{/login}"><i class="fa fa-user-circle-o"></i></a>
                    </div>
                    <!-- toggle switch for light and dark theme -->
                    <div class="mobile-position">
                        <nav class="navigation">
                            <div class="theme-switch-wrapper">
                                <label class="theme-switch" for="checkbox">
                                    <input type="checkbox" id="checkbox">
                                    <div class="mode-container">
                                        <i class="gg-sun"></i>
                                        <i class="gg-moon"></i>
                                    </div>
                                </label>
                            </div>
                        </nav>
                    </div>
                </div>
            </div>
        </nav>
    </header>
    <!--/breadcrumbs -->
    <div class="w3l-breadcrumbs">
        <nav id="breadcrumbs" class="breadcrumbs">
            <div class="container page-wrapper">
                <a th:href="@{/}" >Home</a> » <a th:href="@{/movies}">movies</a> » <span class="breadcrumb_last" id="breadcrumbMovieName" aria-current="page" th:text="${movie != null ? movie.name : 'Chi tiết phim'}">Chi tiết phim</span>
            </div>
        </nav>
    </div>
    <!--/breadcrumbs end-->
    <div class="movie-detail-container">
        <h2 class="movie-detail-title">CHI TIẾT PHIM</h2>
        <div class="movie-detail-main" th:if="${movie != null}">
            <div class="movie-detail-poster">
                <img id="moviePoster" th:src="@{'/web/assets/images/' + ${movie.image}}" th:alt="${movie.name}" alt="Movie Poster">
            </div>
            <div class="movie-detail-info">
                <h1 id="movieTitle" th:text="${movie.name}">Movie Name</h1>
                <p><b>Thể loại:</b> <span id="movieGenre" th:text="${movie.genre}">Genre</span></p>
                <p><b>Đạo diễn:</b> <span id="movieDirector" th:utext="${movie.directors != null and !movie.directors.isEmpty() ? movie.directors.toString().replace('[','').replace(']','') : 'N/A'}">Director</span></p>
                <p><b>Diễn viên:</b> <span id="movieActors" th:utext="${movie.actors != null and !movie.actors.isEmpty() ? movie.actors.toString().replace('[','').replace(']','') : 'N/A'}">Actors</span></p>
                <p><b>Thời lượng:</b> <span id="movieDuration" th:text="${movie.duration != null ? movie.duration : 'N/A'}">Duration</span> phút</p>
                <p><b>Ngôn ngữ:</b> <span id="movieLanguage" th:text="${movie.language != null ? movie.language : 'N/A'}">Language</span></p>
                <p><b>Khởi chiếu:</b> <span id="movieReleaseDate" th:text="${movie.release_date != null ? movie.release_date : 'N/A'}">Release Date</span></p>
                <p><b>Đánh giá:</b> <span id="movieRating" th:text="${movie.rating != null ? movie.rating : 'N/A'}">Rating</span></p>
                <!-- BỎ PHẦN TÓM TẮT -->
                <!-- <p><b>Tóm tắt:</b> <span id="movieSummary" th:text="${movie.summary != null ? movie.summary : 'N/A'}">Summary</span></p> -->
                <button class="btn btn-success" id="bookTicketBtn">Đặt vé</button>
            </div>
        </div>
        <div th:if="${movie == null}" class="text-center">
            <p>Không tìm thấy thông tin phim</p>
            <a th:href="@{/movies}" class="btn btn-primary">Quay lại danh sách phim</a>
        </div>
        <h4>Trailer</h4>
        <div class="trailer-container">
            <iframe id="movieTrailer" width="100%" height="400" th:src="${movie.trailer}" frameborder="0" allowfullscreen></iframe>
        </div>
        <!-- HIỂN THỊ COMMENT -->
        <div class="movie-comments-section">
            <h4>Đánh giá người xem</h4>
            <div th:if="${movie.reviews != null and !movie.reviews.isEmpty()}">
                <div th:each="review : ${movie.reviews}" class="movie-review">
                    <div class="review-user">Người dùng: <span th:text="${review.user}"></span></div>
                    <div class="review-rating">Đánh giá: <span th:text="${review.rating}"></span>/5</div>
                    <div class="review-comment" th:text="${review.comment}"></div>
                    <div class="review-date" th:text="${review.date}"></div>
                </div>
            </div>
            <div th:if="${movie.reviews == null or movie.reviews.isEmpty()}" style="color:#ccc;">Chưa có đánh giá nào.</div>
        </div>
        <button id="showCommentFormBtn" style="margin-top:24px;">Viết đánh giá</button>
        <div class="movie-add-comment" id="addCommentSection" style="display:none;">
            <h4>Viết đánh giá của bạn</h4>
            <textarea id="userComment" placeholder="Nội dung đánh giá"></textarea>
            <select id="userRating">
                <option value="5">5/5</option>
                <option value="4">4/5</option>
                <option value="3">3/5</option>
                <option value="2">2/5</option>
                <option value="1">1/5</option>
            </select>
            <button id="submitComment">Gửi đánh giá</button>
            <div id="commentMsg" style="color:#b2ffb2;margin-top:8px;"></div>
        </div>
        <div id="commentWarnMsg" style="color:#ffb2b2;margin-top:8px;"></div>
    </div>
    <script th:src="@{/web/assets/js/movie_detail.js}"></script>
    <script th:src="@{/web/assets/js/theme-change.js}"></script>
</body>
</html>
  